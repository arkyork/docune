
<!-- PDF.js èª­ã¿è¾¼ã¿ -->


<script>
  document.getElementById("similar-btn").addEventListener("click", async () => {
    const btn = document.getElementById("similar-btn");
    const list = document.getElementById("similar-list");
    const resultsDiv = document.getElementById("similar-results");
    const pk = {{ ref.pk }};
  
    btn.disabled = true;
    btn.textContent = "æ¤œç´¢ä¸­...";
  
    try {
      const res = await fetch(`/api/similar/${pk}/`);
      const data = await res.json();
      list.innerHTML = "";
  
      if (data.results && data.results.length > 0) {
        data.results.forEach(ref => {
          const li = document.createElement("li");
          li.innerHTML = `<a href="/${ref.id}/pdf/" class="text-blue-600 hover:underline">
                            ${ref.title}</a>ï¼ˆé¡ä¼¼åº¦: ${ref.score}ï¼‰`;
          list.appendChild(li);
        });
      } else {
        list.innerHTML = "<li>é¡ä¼¼æ–‡çŒ®ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</li>";
      }
  
      resultsDiv.classList.remove("hidden");
    } catch (err) {
      alert("é¡ä¼¼æ–‡çŒ®ã®æ¤œç´¢ã«å¤±æ•—ã—ã¾ã—ãŸ");
      console.error(err);
    } finally {
      btn.textContent = "ğŸ” é¡ä¼¼æ–‡çŒ®ã‚’æ¢ã™";
      btn.disabled = false;
    }
  });
  </script>